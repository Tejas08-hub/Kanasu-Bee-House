<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kanasu Bee House - Welcome</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="firebase.js"></script>

<style>
:root{
--primary:#f4b400;
--bg:#fffcf0;
--glass:rgba(255,255,255,.95);
--shadow:0 15px 45px rgba(0,0,0,.08);
}

*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:'Montserrat',sans-serif;
}

body{
background:var(--bg);
color:#2d3436;
min-height:100vh;
}

/* TOPBAR */
.topbar{
display:flex;
justify-content:center;
align-items:center;
padding:16px 20px;
background:var(--glass);
position:sticky;
top:0;
z-index:1000;
border-bottom:2px solid rgba(244,180,0,.15);
position:relative;
}

.menu-btn{
position:absolute;
left:20px;
width:42px;
height:42px;
border-radius:12px;
border:1px solid #eee;
background:white;
font-size:18px;
cursor:pointer;
transition:.2s;
}

.menu-btn:hover{
background:#fafafa;
}

.brand{
font-size:20px;
font-weight:800;
}

/* DROPDOWN */
.dropdown{
display:none;
position:absolute;
top:65px;
left:20px;
background:white;
width:290px;
border-radius:18px;
box-shadow:0 20px 50px rgba(0,0,0,.15);
padding:15px;
max-height:450px;
overflow-y:auto;
}

.dropdown.active{
display:block;
}

.dropdown a{
display:block;
padding:12px;
text-decoration:none;
color:#444;
font-weight:600;
border-radius:10px;
font-size:14px;
transition:.2s;
}

.dropdown a:hover{
background:rgba(244,180,0,.12);
color:var(--primary);
}

.section-title{
font-size:11px;
color:#999;
margin:12px 0 6px;
letter-spacing:.5px;
}

/* MAIN */
.main{
max-width:1200px;
margin:auto;
padding:60px 20px 60px;
text-align:center;
}

#welcomeText{
font-size:38px;
font-weight:800;
margin-bottom:10px;
}

.subtitle{
color:#777;
margin-bottom:45px;
font-size:16px;
}

/* CARDS */
.cards{
display:grid;
grid-template-columns:repeat(3,1fr);
gap:28px;
}

.card{
background:white;
padding:35px;
border-radius:24px;
box-shadow:var(--shadow);
cursor:pointer;
transition:.3s ease;
border:3px solid rgba(244,180,0,.15);
}

.card:hover{
transform:translateY(-8px);
box-shadow:0 20px 60px rgba(244,180,0,.25);
border-color:var(--primary);
}

.card h3{
font-size:20px;
margin-bottom:12px;
font-weight:700;
}

.card p{
font-size:15px;
color:#666;
}

/* Tablet */
@media(max-width:950px){
.cards{
grid-template-columns:repeat(2,1fr);
}
#welcomeText{
font-size:30px;
}
}

/* Mobile */
@media(max-width:600px){
.cards{
grid-template-columns:1fr;
gap:20px;
}
.card{
padding:25px;
}
#welcomeText{
font-size:24px;
}
.subtitle{
font-size:14px;
}
}

/* Paired Hive */
.hive-item{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:10px;
font-size:14px;
}
.hive-item span{
cursor:pointer;
}
</style>
</head>

<body>

<div class="topbar">

<button class="menu-btn" onclick="toggleMenu()">‚ò∞</button>

<div class="dropdown" id="menuDropdown">

<a onclick="openDemo()">üìä Demo Dashboard</a>
<a onclick="pairHive()">‚ûï Add New Hive</a>

<div class="section-title">Paired Hives</div>
<div id="dashboardList"></div>

<hr style="margin:12px 0;">

<a href="calculator.html">üçØ Honey Calculator</a>
<a href="learning.html">üéì Learning Centre</a>
<a href="market.html">üìà Market Analysis</a>
<a href="chatbot.html">ü§ñ Kanasu Chatbot</a>
<a href="image-disease.html">üêù Bee Scan AI</a>
<a href="about.html">‚ÑπÔ∏è About Project</a>

<hr style="margin:12px 0;">
<a onclick="logout()" style="color:#e74c3c;">Logout</a>

</div>

<div class="brand">
<span style="color:black;">Kanasu </span>
<span style="color:#f4b400;">Bee House</span>
</div>

</div>

<div class="main">

<h1 id="welcomeText">Loading...</h1>
<p class="subtitle">Let‚Äôs take care of your hives today.</p>

<div class="cards">

<div class="card" onclick="openDemo()">
<h3>üìä Demo Dashboard</h3>
<p>Explore real-time simulated hive analytics.</p>
</div>

<div class="card" onclick="pairHive()">
<h3>‚ûï Add New Hive</h3>
<p>Connect your registered hive using Hive ID and PIN.</p>
</div>

<div class="card" onclick="location.href='calculator.html'">
<h3>üçØ Honey Calculator</h3>
<p>Estimate honey production and yield.</p>
</div>

<div class="card" onclick="location.href='videos.html'">
<h3>üéì Learning Centre</h3>
<p>Educational resources and training materials.</p>
</div>

<div class="card" onclick="location.href='chatbot.html'">
<h3>ü§ñ Kanasu Chatbot</h3>
<p>Your AI-powered hive assistant.</p>
</div>

<div class="card" onclick="location.href='image-disease.html'">
<h3>üêù Bee Scan AI</h3>
<p>Sound & image based disease detection.</p>
</div>

</div>

</div>

<script>
let pairedHives=JSON.parse(localStorage.getItem("pairedHives"))||[];

function toggleMenu(){
menuDropdown.classList.toggle("active");
}

firebase.auth().onAuthStateChanged(user=>{
if(user){
firebase.database().ref("users/"+user.uid).once("value")
.then(snapshot=>{
let data=snapshot.val();
if(data && data.name){
welcomeText.innerHTML=
`<span style="color:black;">Welcome </span>
<span style="color:#f4b400;">${data.name}</span>`;
}else{
welcomeText.innerHTML="Welcome";
}
});
}else{
window.location.href="index.html";
}
});

function openDemo(){
window.location.href="dashboard.html";
}

function pairHive(){
let hiveId=prompt("Enter Hive ID");
if(!hiveId) return;
let pin=prompt("Enter Hive PIN");
if(!pin) return;
let customName=prompt("Enter Custom Hive Name (e.g North East Hive)");
if(!customName) return;

firebase.database().ref("hives/"+hiveId).once("value").then(snapshot=>{
if(!snapshot.exists()){
alert("Hive not found!");
return;
}
if(String(snapshot.val().pin)===String(pin)){
alert("Hive Paired Successfully!");
pairedHives.push({id:hiveId,name:customName});
localStorage.setItem("pairedHives",JSON.stringify(pairedHives));
renderList();
}else{
alert("Incorrect PIN");
}
});
}

function renderList(){
dashboardList.innerHTML="";
pairedHives.forEach((h,index)=>{
let div=document.createElement("div");
div.className="hive-item";
let name=document.createElement("span");
name.innerText=" "+h.name;
name.onclick=()=>{
localStorage.setItem("activeHiveId",h.id);
localStorage.setItem("activeHiveName",h.name);
window.location.href="live-dashboard.html";
};
let del=document.createElement("span");
del.innerText="‚ùå";
del.onclick=()=>{
pairedHives.splice(index,1);
localStorage.setItem("pairedHives",JSON.stringify(pairedHives));
renderList();
};
div.appendChild(name);
div.appendChild(del);
dashboardList.appendChild(div);
});
}

function logout(){
firebase.auth().signOut().then(()=>window.location.href="index.html");
}

renderList();
</script>

</body>
</html>