<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bee Scan AI | Kanasu Bee House</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root{
--honey:#f4b400;
--bg1:#fff9e6;
--bg2:#fff2c7;
--card-bg:rgba(255,255,255,0.95);
--shadow:0 15px 40px rgba(0,0,0,0.08);
}

*{box-sizing:border-box;font-family:'Montserrat',sans-serif}

body{
margin:0;
min-height:100vh;
background:linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 100%);
}

/* Top Bar like Dashboard */
.topbar{
display:flex;
align-items:center;
padding:15px 20px;
background:white;
box-shadow:0 5px 15px rgba(0,0,0,0.05);
position:sticky;
top:0;
z-index:100;
}

.back-btn{
text-decoration:none;
font-weight:700;
color:#333;
}

.container{
max-width:520px;
margin:auto;
padding:20px;
}

/* Header */
.header{
text-align:center;
margin-bottom:20px;
}

.header h1{
font-weight:800;
font-size:26px;
}

.header h1 span{
color:var(--honey);
}

.header p{
font-size:12px;
font-weight:600;
color:#7a6300;
}

/* Card */
.preview-card{
background:var(--card-bg);
border-radius:25px;
padding:15px;
box-shadow:var(--shadow);
margin-bottom:20px;
}

.viewport{
width:100%;
aspect-ratio:1;
background:#fffef7;
border-radius:20px;
overflow:hidden;
display:flex;
align-items:center;
justify-content:center;
position:relative;
}

#preview{
width:100%;
height:100%;
object-fit:cover;
display:none;
}

.scan-bar{
display:none;
position:absolute;
width:100%;
height:4px;
background:var(--honey);
animation:moveScan 2s linear infinite;
}

@keyframes moveScan{
0%{top:0}
100%{top:100%}
}

.button-grid{
display:grid;
grid-template-columns:1fr 1fr;
gap:12px;
margin-bottom:15px;
}

.btn-action{
background:white;
border:none;
padding:14px;
border-radius:15px;
font-weight:700;
cursor:pointer;
box-shadow:0 4px 10px rgba(0,0,0,0.05);
}

.btn-main{
width:100%;
background:var(--honey);
border:none;
padding:18px;
border-radius:18px;
font-weight:800;
cursor:pointer;
box-shadow:0 8px 25px rgba(244,180,0,0.3);
}

.result-box{
margin-top:20px;
padding:20px;
background:white;
border-radius:20px;
display:none;
box-shadow:var(--shadow);
}

.download-btn{
width:100%;
background:#2d3436;
color:white;
border:none;
padding:14px;
border-radius:12px;
font-weight:700;
margin-top:15px;
cursor:pointer;
}

input[type="file"]{display:none}
</style>
</head>
<body>

<div class="topbar">
<a href="dashboard.html" class="back-btn">‚Üê Dashboard</a>
</div>

<div class="container">

<div class="header">
<h1>Bee Scan <span>AI</span></h1>
<p>Vision-Based Hive Disease Detection</p>
</div>

<div class="preview-card">
<div class="viewport">
<div id="scanner" class="scan-bar"></div>
<div id="status" style="text-align:center;">
<div style="font-size:2rem;">üì∏</div>
<div style="font-weight:700;color:#999;font-size:12px;">
AWAITING IMAGE
</div>
</div>
<img id="preview">
</div>
</div>

<div class="button-grid">
<label for="imgInputCam" class="btn-action">üì∑ CAMERA</label>
<input type="file" id="imgInputCam" accept="image/*" capture="environment">

<label for="imgInputGal" class="btn-action">üñºÔ∏è GALLERY</label>
<input type="file" id="imgInputGal" accept="image/*">
</div>

<button class="btn-main" id="analyzeBtn" onclick="runScan()">
Identify Disease
</button>

<div id="result" class="result-box">
<div id="resultContent"></div>
<button class="download-btn" onclick="generateReport()">
üì• Download PDF Report
</button>
</div>

</div>

<script>
const camInput=document.getElementById("imgInputCam");
const galInput=document.getElementById("imgInputGal");
const preview=document.getElementById("preview");
const scanner=document.getElementById("scanner");
const status=document.getElementById("status");
const resultDiv=document.getElementById("result");
const resultContent=document.getElementById("resultContent");
const analyzeBtn=document.getElementById("analyzeBtn");

const handleFile=(e)=>{
const file=e.target.files[0];
if(file){
preview.src=URL.createObjectURL(file);
preview.style.display="block";
status.style.display="none";
resultDiv.style.display="none";
scanner.style.display="none";
}
};

camInput.onchange=handleFile;
galInput.onchange=handleFile;

async function runScan(){
if(!preview.src){
alert("Please upload or capture an image");
return;
}

scanner.style.display="block";
analyzeBtn.innerText="Analyzing Hive...";
resultDiv.style.display="none";

await new Promise(r=>setTimeout(r,2500));

scanner.style.display="none";
analyzeBtn.innerText="Identify Disease";
resultDiv.style.display="block";

resultContent.innerHTML=`
<b>üß† Prediction:</b> Possible Varroa Mite (Prototype)<br>
<b>Confidence:</b> Low ‚Äì Model under training<br><br>
<b>Recommended Actions:</b>
<ul style="padding-left:20px;line-height:1.6;">
<li>Inspect hive manually for mites</li>
<li>Confirm using sound + image correlation</li>
<li>Apply integrated pest management</li>
<li>Consult local apiculture officer</li>
</ul>
`;
}

/* Professional PDF with Image */
async function generateReport(){
const {jsPDF}=window.jspdf;
const doc=new jsPDF();

doc.setDrawColor(180);
doc.rect(10,10,190,277);

doc.setFont("helvetica","bold");
doc.setFontSize(18);
doc.text("BEE SCAN AI REPORT",105,25,null,null,"center");

doc.setFontSize(12);
doc.text("Generated: "+new Date().toLocaleString(),20,40);

if(preview.src){
const imgData=preview.src;
doc.addImage(imgData,"JPEG",20,50,170,90);
}

let y=150;

doc.setFontSize(13);
doc.text("Prediction: Possible Varroa Mite (Prototype)",20,y);
y+=12;
doc.text("Confidence: Low ‚Äì Model under training",20,y);
y+=18;

doc.text("Recommended Actions:",20,y);
y+=12;
doc.text("- Inspect hive manually for mites",25,y); y+=10;
doc.text("- Confirm using sound + image correlation",25,y); y+=10;
doc.text("- Apply integrated pest management",25,y); y+=10;
doc.text("- Consult local apiculture officer",25,y);

doc.save("Bee_Scan_AI_Report.pdf");
}
</script>

</body>
</html>